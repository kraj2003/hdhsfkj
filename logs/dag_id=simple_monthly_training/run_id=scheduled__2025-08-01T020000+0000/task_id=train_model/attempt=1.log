[2025-09-11T10:11:23.880+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-09-11T10:11:23.928+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: simple_monthly_training.train_model scheduled__2025-08-01T02:00:00+00:00 [queued]>
[2025-09-11T10:11:23.939+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: simple_monthly_training.train_model scheduled__2025-08-01T02:00:00+00:00 [queued]>
[2025-09-11T10:11:23.940+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2025-09-11T10:11:23.958+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): train_model> on 2025-08-01 02:00:00+00:00
[2025-09-11T10:11:23.981+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'simple_monthly_training', 'train_model', 'scheduled__2025-08-01T02:00:00+00:00', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/train_model_dag.py', '--cfg-path', '/tmp/tmpml__3rcb']
[2025-09-11T10:11:23.984+0000] {standard_task_runner.py:91} INFO - Job 35: Subtask train_model
[2025-09-11T10:11:23.987+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62 DeprecationWarning: This process (pid=443) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-09-11T10:11:23.988+0000] {standard_task_runner.py:64} INFO - Started process 465 to run task
[2025-09-11T10:11:24.074+0000] {task_command.py:426} INFO - Running <TaskInstance: simple_monthly_training.train_model scheduled__2025-08-01T02:00:00+00:00 [running]> on host 94617eeb311b
[2025-09-11T10:11:24.192+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='ml-team' AIRFLOW_CTX_DAG_ID='simple_monthly_training' AIRFLOW_CTX_TASK_ID='train_model' AIRFLOW_CTX_EXECUTION_DATE='2025-08-01T02:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-08-01T02:00:00+00:00'
[2025-09-11T10:11:24.199+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-09-11T10:11:24.216+0000] {logging_mixin.py:188} INFO - 🚀 Starting model training...
[2025-09-11T10:12:30.400+0000] {logging_mixin.py:188} INFO - Loaded 3137151 records
[2025-09-11T10:12:30.489+0000] {logging_mixin.py:188} INFO - Starting preprocessing...
[2025-09-11T10:12:35.148+0000] {logging_mixin.py:188} INFO - Original data shape: (3137151, 23)
[2025-09-11T10:12:35.186+0000] {logging_mixin.py:188} INFO - Delay instances: 143531/3137151 (4.6%)
[2025-09-11T10:12:46.164+0000] {logging_mixin.py:188} INFO - After resampling: (40701, 5)
[2025-09-11T10:12:46.502+0000] {logging_mixin.py:188} INFO - After feature engineering: (40701, 27)
[2025-09-11T10:12:46.522+0000] {logging_mixin.py:188} INFO - Target distribution: {1: 22011, 0: 18690}
[2025-09-11T10:12:46.524+0000] {logging_mixin.py:188} INFO - Target balance: 54.1% positive class
[2025-09-11T10:12:46.558+0000] {logging_mixin.py:188} INFO - NaN values remaining: 21
[2025-09-11T10:12:46.561+0000] {logging_mixin.py:188} INFO - Preprocessing complete.
[2025-09-11T10:12:46.826+0000] {logging_mixin.py:188} INFO - train data                       Delay_Detected  response_time  ...  future_delay  target
timestamp                                           ...                      
2025-05-22 07:20:00             1.0    2415.625000  ...           1.0       1
2025-05-22 07:25:00             1.0   10735.000000  ...           0.0       0
2025-05-22 07:30:00             1.0   15960.714286  ...           1.0       1
2025-05-22 07:35:00             0.0     710.666667  ...           NaN       0
2025-05-22 07:40:00             1.0    1079.538462  ...           NaN       0

[5 rows x 27 columns]
[2025-09-11T10:12:46.876+0000] {logging_mixin.py:188} INFO - test_data                      Delay_Detected  response_time  ...  future_delay  target
timestamp                                           ...                      
2025-05-22 07:20:00             1.0    2415.625000  ...           1.0       1
2025-05-22 07:25:00             1.0   10735.000000  ...           0.0       0
2025-05-22 07:30:00             1.0   15960.714286  ...           1.0       1
2025-05-22 07:35:00             0.0     710.666667  ...           NaN       0
2025-05-22 07:40:00             1.0    1079.538462  ...           NaN       0

[5 rows x 27 columns]
[2025-09-11T10:12:48.291+0000] {logging_mixin.py:188} INFO - Processed to 40701 samples
[2025-09-11T10:12:48.294+0000] {logging_mixin.py:188} INFO - Using features: ['CPU', 'RAM', 'response_time', 'is_error', 'cpu_rolling_mean', 'ram_rolling_mean', 'response_rolling_mean', 'high_cpu', 'high_ram', 'is_peak_hour', 'hour']
[2025-09-11T10:12:48.310+0000] {logging_mixin.py:188} INFO - Feature matrix shape: (40701, 11)
[2025-09-11T10:12:48.311+0000] {logging_mixin.py:188} INFO - Target shape: (40701,)
[2025-09-11T10:12:48.325+0000] {logging_mixin.py:188} INFO - Target distribution: [18690 22011]
[2025-09-11T10:12:49.406+0000] {logging_mixin.py:188} INFO - Sequence shape: X=(40677, 24, 11), y=(40677,)
[2025-09-11T10:12:50.914+0000] {logging_mixin.py:188} INFO - Train set: (32541, 24, 11), (32541,)
[2025-09-11T10:12:50.915+0000] {logging_mixin.py:188} INFO - Val set: (8136, 24, 11), (8136,)
[2025-09-11T10:12:50.916+0000] {logging_mixin.py:188} INFO - Train target distribution: [14785 17756]
[2025-09-11T10:12:50.918+0000] {logging_mixin.py:188} INFO - Val target distribution: [3885 4251]
[2025-09-11T10:12:50.980+0000] {logging_mixin.py:188} INFO - Class weights: {0: 1.1004734528238078, 1: 0.9163381392205452}
[2025-09-11T10:12:52.932+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/keras/src/layers/rnn/rnn.py:199 UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
[2025-09-11T10:12:54.781+0000] {logging_mixin.py:188} INFO - Epoch 1/20
[2025-09-11T10:13:31.162+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/keras/src/callbacks/early_stopping.py:99 UserWarning: Early stopping conditioned on metric `val_recall` which is not available. Available metrics are: AUC,Precision,Recall,accuracy,loss,val_AUC,val_Precision,val_Recall,val_accuracy,val_loss
[2025-09-11T10:13:31.175+0000] {logging_mixin.py:188} INFO - 1017/1017 - 36s - 36ms/step - AUC: 0.8214 - Precision: 0.8677 - Recall: 0.6650 - accuracy: 0.7618 - loss: 1.0450 - val_AUC: 0.8174 - val_Precision: 0.7761 - val_Recall: 0.7347 - val_accuracy: 0.7506 - val_loss: 1.0217
[2025-09-11T10:13:31.181+0000] {logging_mixin.py:188} INFO - Epoch 2/20
[2025-09-11T10:13:59.407+0000] {logging_mixin.py:188} INFO - 1017/1017 - 28s - 28ms/step - AUC: 0.8316 - Precision: 0.8868 - Recall: 0.6618 - accuracy: 0.7694 - loss: 1.0032 - val_AUC: 0.8170 - val_Precision: 0.7818 - val_Recall: 0.7325 - val_accuracy: 0.7534 - val_loss: 0.9801
[2025-09-11T10:13:59.411+0000] {logging_mixin.py:188} INFO - Epoch 3/20
[2025-09-11T10:14:28.267+0000] {logging_mixin.py:188} INFO - 1017/1017 - 29s - 28ms/step - AUC: 0.8348 - Precision: 0.8861 - Recall: 0.6673 - accuracy: 0.7716 - loss: 0.9905 - val_AUC: 0.8218 - val_Precision: 0.7953 - val_Recall: 0.7201 - val_accuracy: 0.7569 - val_loss: 1.0022
[2025-09-11T10:14:28.285+0000] {logging_mixin.py:188} INFO - Epoch 4/20
[2025-09-11T10:14:58.593+0000] {logging_mixin.py:188} INFO - 1017/1017 - 30s - 30ms/step - AUC: 0.8367 - Precision: 0.8890 - Recall: 0.6694 - accuracy: 0.7740 - loss: 0.9830 - val_AUC: 0.8186 - val_Precision: 0.8036 - val_Recall: 0.7161 - val_accuracy: 0.7602 - val_loss: 0.9995
[2025-09-11T10:14:58.598+0000] {logging_mixin.py:188} INFO - Epoch 5/20
[2025-09-11T10:15:33.809+0000] {logging_mixin.py:188} INFO - 1017/1017 - 35s - 35ms/step - AUC: 0.8377 - Precision: 0.8931 - Recall: 0.6660 - accuracy: 0.7743 - loss: 0.9774 - val_AUC: 0.8165 - val_Precision: 0.8190 - val_Recall: 0.6961 - val_accuracy: 0.7608 - val_loss: 0.9875
[2025-09-11T10:15:33.815+0000] {logging_mixin.py:188} INFO - Epoch 6/20
[2025-09-11T10:16:09.373+0000] {logging_mixin.py:188} INFO - 1017/1017 - 36s - 35ms/step - AUC: 0.8385 - Precision: 0.8942 - Recall: 0.6682 - accuracy: 0.7758 - loss: 0.9733 - val_AUC: 0.8193 - val_Precision: 0.7920 - val_Recall: 0.7264 - val_accuracy: 0.7574 - val_loss: 0.9709
[2025-09-11T10:16:09.382+0000] {logging_mixin.py:188} INFO - Epoch 7/20
[2025-09-11T10:16:50.840+0000] {logging_mixin.py:188} INFO - 1017/1017 - 41s - 41ms/step - AUC: 0.8392 - Precision: 0.8921 - Recall: 0.6703 - accuracy: 0.7759 - loss: 0.9718 - val_AUC: 0.8148 - val_Precision: 0.7975 - val_Recall: 0.7236 - val_accuracy: 0.7596 - val_loss: 0.9928
[2025-09-11T10:16:50.848+0000] {logging_mixin.py:188} INFO - Epoch 8/20
[2025-09-11T10:17:30.072+0000] {logging_mixin.py:188} INFO - 1017/1017 - 39s - 39ms/step - AUC: 0.8394 - Precision: 0.8956 - Recall: 0.6678 - accuracy: 0.7763 - loss: 0.9668 - val_AUC: 0.8174 - val_Precision: 0.8074 - val_Recall: 0.7043 - val_accuracy: 0.7577 - val_loss: 0.9598
[2025-09-11T10:17:30.081+0000] {logging_mixin.py:188} INFO - Epoch 9/20
[2025-09-11T10:18:07.381+0000] {logging_mixin.py:188} INFO - 1017/1017 - 37s - 37ms/step - AUC: 0.8400 - Precision: 0.8955 - Recall: 0.6687 - accuracy: 0.7767 - loss: 0.9666 - val_AUC: 0.8138 - val_Precision: 0.8033 - val_Recall: 0.7139 - val_accuracy: 0.7592 - val_loss: 1.0294
[2025-09-11T10:18:07.387+0000] {logging_mixin.py:188} INFO - Epoch 10/20
[2025-09-11T10:18:40.537+0000] {logging_mixin.py:188} INFO - 1017/1017 - 33s - 33ms/step - AUC: 0.8416 - Precision: 0.9000 - Recall: 0.6654 - accuracy: 0.7771 - loss: 0.9620 - val_AUC: 0.8127 - val_Precision: 0.7898 - val_Recall: 0.7318 - val_accuracy: 0.7581 - val_loss: 1.0374
[2025-09-11T10:18:40.547+0000] {logging_mixin.py:188} INFO - Epoch 11/20
[2025-09-11T10:19:14.640+0000] {logging_mixin.py:188} INFO - 1017/1017 - 34s - 34ms/step - AUC: 0.8420 - Precision: 0.9024 - Recall: 0.6670 - accuracy: 0.7789 - loss: 0.9582 - val_AUC: 0.8141 - val_Precision: 0.7980 - val_Recall: 0.7231 - val_accuracy: 0.7597 - val_loss: 0.9818
[2025-09-11T10:19:14.647+0000] {logging_mixin.py:188} INFO - Epoch 12/20
[2025-09-11T10:19:47.564+0000] {logging_mixin.py:188} INFO - 1017/1017 - 33s - 32ms/step - AUC: 0.8426 - Precision: 0.9015 - Recall: 0.6675 - accuracy: 0.7788 - loss: 0.9563 - val_AUC: 0.8169 - val_Precision: 0.8083 - val_Recall: 0.7090 - val_accuracy: 0.7601 - val_loss: 0.9772
[2025-09-11T10:19:47.570+0000] {logging_mixin.py:188} INFO - Epoch 13/20
[2025-09-11T10:20:21.329+0000] {logging_mixin.py:188} INFO - 1017/1017 - 34s - 33ms/step - AUC: 0.8430 - Precision: 0.9073 - Recall: 0.6649 - accuracy: 0.7801 - loss: 0.9512 - val_AUC: 0.8122 - val_Precision: 0.8086 - val_Recall: 0.7038 - val_accuracy: 0.7582 - val_loss: 0.9604
[2025-09-11T10:20:21.335+0000] {logging_mixin.py:188} INFO - Epoch 14/20
[2025-09-11T10:20:58.334+0000] {logging_mixin.py:188} INFO - 1017/1017 - 37s - 36ms/step - AUC: 0.8448 - Precision: 0.9038 - Recall: 0.6706 - accuracy: 0.7813 - loss: 0.9471 - val_AUC: 0.8119 - val_Precision: 0.7970 - val_Recall: 0.7165 - val_accuracy: 0.7565 - val_loss: 0.9866
[2025-09-11T10:20:58.341+0000] {logging_mixin.py:188} INFO - Epoch 15/20
[2025-09-11T10:21:31.616+0000] {logging_mixin.py:188} INFO - 1017/1017 - 33s - 33ms/step - AUC: 0.8446 - Precision: 0.9045 - Recall: 0.6706 - accuracy: 0.7817 - loss: 0.9463 - val_AUC: 0.8150 - val_Precision: 0.8093 - val_Recall: 0.7029 - val_accuracy: 0.7582 - val_loss: 0.9782
[2025-09-11T10:21:31.626+0000] {logging_mixin.py:188} INFO - Epoch 16/20
[2025-09-11T10:22:04.117+0000] {logging_mixin.py:188} INFO - 1017/1017 - 32s - 32ms/step - AUC: 0.8465 - Precision: 0.9092 - Recall: 0.6683 - accuracy: 0.7826 - loss: 0.9391 - val_AUC: 0.8094 - val_Precision: 0.8017 - val_Recall: 0.7172 - val_accuracy: 0.7596 - val_loss: 1.0097
[2025-09-11T10:22:04.125+0000] {logging_mixin.py:188} INFO - Epoch 17/20
[2025-09-11T10:22:38.598+0000] {logging_mixin.py:188} INFO - 1017/1017 - 34s - 34ms/step - AUC: 0.8498 - Precision: 0.9088 - Recall: 0.6701 - accuracy: 0.7833 - loss: 0.9330 - val_AUC: 0.8220 - val_Precision: 0.7875 - val_Recall: 0.7281 - val_accuracy: 0.7553 - val_loss: 1.0289
[2025-09-11T10:22:38.606+0000] {logging_mixin.py:188} INFO - Epoch 18/20
[2025-09-11T10:23:12.061+0000] {logging_mixin.py:188} INFO - 1017/1017 - 33s - 33ms/step - AUC: 0.8651 - Precision: 0.9109 - Recall: 0.6695 - accuracy: 0.7839 - loss: 0.9040 - val_AUC: 0.8512 - val_Precision: 0.7964 - val_Recall: 0.7278 - val_accuracy: 0.7606 - val_loss: 0.9624
[2025-09-11T10:23:12.079+0000] {logging_mixin.py:188} INFO - Epoch 19/20
[2025-09-11T10:23:44.810+0000] {logging_mixin.py:188} INFO - 1017/1017 - 33s - 32ms/step - AUC: 0.8835 - Precision: 0.9023 - Recall: 0.7114 - accuracy: 0.8005 - loss: 0.8656 - val_AUC: 0.8407 - val_Precision: 0.7933 - val_Recall: 0.7558 - val_accuracy: 0.7695 - val_loss: 0.9678
[2025-09-11T10:23:44.827+0000] {logging_mixin.py:188} INFO - Epoch 20/20
[2025-09-11T10:24:16.914+0000] {logging_mixin.py:188} INFO - 1017/1017 - 32s - 32ms/step - AUC: 0.8928 - Precision: 0.8992 - Recall: 0.7378 - accuracy: 0.8118 - loss: 0.8341 - val_AUC: 0.8710 - val_Precision: 0.8201 - val_Recall: 0.7892 - val_accuracy: 0.7994 - val_loss: 0.8838
[2025-09-11T10:24:18.633+0000] {logging_mixin.py:188} INFO -   1/255 ━━━━━━━━━━━━━━━━━━━━ 4:45 1s/step
[2025-09-11T10:24:18.649+0000] {logging_mixin.py:188} INFO -   2/255 ━━━━━━━━━━━━━━━━━━━━ 13s 53ms/step
[2025-09-11T10:24:18.706+0000] {logging_mixin.py:188} INFO -   7/255 ━━━━━━━━━━━━━━━━━━━━ 4s 18ms/step 
[2025-09-11T10:24:18.761+0000] {logging_mixin.py:188} INFO -  12/255 ━━━━━━━━━━━━━━━━━━━━ 3s 15ms/step
[2025-09-11T10:24:18.819+0000] {logging_mixin.py:188} INFO -  17/255 ━━━━━━━━━━━━━━━━━━━━ 3s 14ms/step
[2025-09-11T10:24:18.871+0000] {logging_mixin.py:188} INFO -  22/255 ━━━━━━━━━━━━━━━━━━━━ 3s 13ms/step
[2025-09-11T10:24:18.926+0000] {logging_mixin.py:188} INFO -  27/255 ━━━━━━━━━━━━━━━━━━━━ 2s 13ms/step
[2025-09-11T10:24:18.981+0000] {logging_mixin.py:188} INFO -  32/255 ━━━━━━━━━━━━━━━━━━━━ 2s 12ms/step
[2025-09-11T10:24:19.032+0000] {logging_mixin.py:188} INFO -  36/255 ━━━━━━━━━━━━━━━━━━━━ 2s 12ms/step
[2025-09-11T10:24:19.082+0000] {logging_mixin.py:188} INFO -  39/255 ━━━━━━━━━━━━━━━━━━━━ 2s 13ms/step
[2025-09-11T10:24:19.136+0000] {logging_mixin.py:188} INFO -  43/255 ━━━━━━━━━━━━━━━━━━━━ 2s 13ms/step
[2025-09-11T10:24:19.188+0000] {logging_mixin.py:188} INFO -  47/255 ━━━━━━━━━━━━━━━━━━━━ 2s 13ms/step
[2025-09-11T10:24:19.242+0000] {logging_mixin.py:188} INFO -  52/255 ━━━━━━━━━━━━━━━━━━━━ 2s 13ms/step
[2025-09-11T10:24:19.299+0000] {logging_mixin.py:188} INFO -  58/255 ━━━━━━━━━━━━━━━━━━━━ 2s 12ms/step
[2025-09-11T10:24:19.351+0000] {logging_mixin.py:188} INFO -  64/255 ━━━━━━━━━━━━━━━━━━━━ 2s 12ms/step
[2025-09-11T10:24:19.406+0000] {logging_mixin.py:188} INFO -  70/255 ━━━━━━━━━━━━━━━━━━━━ 2s 12ms/step
[2025-09-11T10:24:19.459+0000] {logging_mixin.py:188} INFO -  76/255 ━━━━━━━━━━━━━━━━━━━━ 2s 12ms/step
[2025-09-11T10:24:19.512+0000] {logging_mixin.py:188} INFO -  82/255 ━━━━━━━━━━━━━━━━━━━━ 1s 11ms/step
[2025-09-11T10:24:19.569+0000] {logging_mixin.py:188} INFO -  89/255 ━━━━━━━━━━━━━━━━━━━━ 1s 11ms/step
[2025-09-11T10:24:19.625+0000] {logging_mixin.py:188} INFO -  96/255 ━━━━━━━━━━━━━━━━━━━━ 1s 11ms/step
[2025-09-11T10:24:19.679+0000] {logging_mixin.py:188} INFO - 103/255 ━━━━━━━━━━━━━━━━━━━━ 1s 11ms/step
[2025-09-11T10:24:19.734+0000] {logging_mixin.py:188} INFO - 110/255 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step
[2025-09-11T10:24:19.789+0000] {logging_mixin.py:188} INFO - 117/255 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step
[2025-09-11T10:24:19.844+0000] {logging_mixin.py:188} INFO - 124/255 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step
[2025-09-11T10:24:19.900+0000] {logging_mixin.py:188} INFO - 131/255 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step
[2025-09-11T10:24:19.953+0000] {logging_mixin.py:188} INFO - 137/255 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step
[2025-09-11T10:24:20.007+0000] {logging_mixin.py:188} INFO - 143/255 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step
[2025-09-11T10:24:20.062+0000] {logging_mixin.py:188} INFO - 150/255 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step
[2025-09-11T10:24:20.120+0000] {logging_mixin.py:188} INFO - 157/255 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step
[2025-09-11T10:24:20.177+0000] {logging_mixin.py:188} INFO - 164/255 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step
[2025-09-11T10:24:20.231+0000] {logging_mixin.py:188} INFO - 171/255 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step
[2025-09-11T10:24:20.288+0000] {logging_mixin.py:188} INFO - 178/255 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step
[2025-09-11T10:24:20.338+0000] {logging_mixin.py:188} INFO - 184/255 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step
[2025-09-11T10:24:20.390+0000] {logging_mixin.py:188} INFO - 191/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step 
[2025-09-11T10:24:20.443+0000] {logging_mixin.py:188} INFO - 198/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.500+0000] {logging_mixin.py:188} INFO - 205/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.552+0000] {logging_mixin.py:188} INFO - 212/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.604+0000] {logging_mixin.py:188} INFO - 218/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.656+0000] {logging_mixin.py:188} INFO - 224/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.709+0000] {logging_mixin.py:188} INFO - 230/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.760+0000] {logging_mixin.py:188} INFO - 236/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.826+0000] {logging_mixin.py:188} INFO - 240/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.885+0000] {logging_mixin.py:188} INFO - 244/255 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
[2025-09-11T10:24:20.942+0000] {logging_mixin.py:188} INFO - 247/255 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step
[2025-09-11T10:24:21.001+0000] {logging_mixin.py:188} INFO - 250/255 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step
[2025-09-11T10:24:21.053+0000] {logging_mixin.py:188} INFO - 253/255 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step
[2025-09-11T10:24:21.643+0000] {logging_mixin.py:188} INFO - 255/255 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step
[2025-09-11T10:24:21.669+0000] {logging_mixin.py:188} INFO - 255/255 ━━━━━━━━━━━━━━━━━━━━ 4s 12ms/step
[2025-09-11T10:24:21.926+0000] {logging_mixin.py:188} INFO - 
Confusion Matrix:
[2025-09-11T10:24:21.932+0000] {logging_mixin.py:188} INFO - [[3149  736]
 [ 896 3355]]
[2025-09-11T10:24:21.953+0000] {logging_mixin.py:188} INFO - Best F1 threshold: 0.4250461 F1: 0.8119548784737413
[2025-09-11T10:24:22.008+0000] {logging_mixin.py:188} INFO - checking the accuracy
[2025-09-11T10:24:22.010+0000] {logging_mixin.py:188} INFO - [1 0 0 0 1 1 1 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1] [0 1 0 0 0 1 0 1 0 1 1 1 1 1 0 0 0 0 0 1 0 1 1 0 1 1 1 1 1 1]
[2025-09-11T10:24:22.010+0000] {logging_mixin.py:188} INFO - 
==================================================
[2025-09-11T10:24:22.011+0000] {logging_mixin.py:188} INFO - MODEL PERFORMANCE:
[2025-09-11T10:24:22.012+0000] {logging_mixin.py:188} INFO - Accuracy: 0.799
[2025-09-11T10:24:22.012+0000] {logging_mixin.py:188} INFO - Precision: 0.820
[2025-09-11T10:24:22.013+0000] {logging_mixin.py:188} INFO - Recall: 0.789
[2025-09-11T10:24:22.014+0000] {logging_mixin.py:188} INFO - F1-Score: 0.804
[2025-09-11T10:24:22.015+0000] {logging_mixin.py:188} INFO - ==================================================
[2025-09-11T10:24:22.016+0000] {logging_mixin.py:188} INFO - 
Detailed Classification Report:
[2025-09-11T10:24:22.036+0000] {logging_mixin.py:188} INFO -               precision    recall  f1-score   support

    No Delay       0.78      0.81      0.79      3885
       Delay       0.82      0.79      0.80      4251

    accuracy                           0.80      8136
   macro avg       0.80      0.80      0.80      8136
weighted avg       0.80      0.80      0.80      8136
[2025-09-11T10:24:22.049+0000] {saving_api.py:83} WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
[2025-09-11T10:24:23.448+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:24:23 INFO mlflow.tracking.fluent: Experiment with name 'delay_prediction' does not exist. Creating a new experiment.
[2025-09-11T10:24:24.265+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:24:24 WARNING mlflow.utils.git_utils: Failed to import Git (the Git executable is probably not on your PATH), so Git SHA is not available. Error: Failed to initialize: Bad git executable.
The git executable must be specified in one of the following ways:
    - be included in your $PATH
    - be set via $GIT_PYTHON_GIT_EXECUTABLE
    - explicitly set via git.refresh(<full-path-to-git-executable>)

All git commands will error until this is rectified.

This initial message can be silenced or aggravated in the future by setting the
$GIT_PYTHON_REFRESH environment variable. Use one of the following values:
    - quiet|q|silence|s|silent|none|n|0: for no message or exception
    - warn|w|warning|log|l|1: for a warning message (logging level CRITICAL, displayed by default)
    - error|e|exception|raise|r|2: for a raised exception

Example:
    export GIT_PYTHON_REFRESH=quiet
[2025-09-11T10:24:25.364+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:24:25 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.
[2025-09-11T10:24:25.501+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:24:25 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.
[2025-09-11T10:24:58.807+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:24:58 WARNING mlflow.utils.environment: Encountered an unexpected error while inferring pip requirements (model URI: /tmp/tmpavke808h/model, flavor: keras). Fall back to return ['keras==3.11.3']. Set logging level to DEBUG to see the full traceback.
[2025-09-11T10:24:58.823+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:24:58 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.
[2025-09-11T10:24:58.862+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:24:58 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.
[2025-09-11T10:24:58.947+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:24:58 WARNING mlflow.sklearn: Model was missing function: predict. Not logging python_function flavor!
[2025-09-11T10:25:06.525+0000] {logging_mixin.py:188} WARNING - 2025/09/11 10:25:06 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.
[2025-09-11T10:25:06.550+0000] {logging_mixin.py:188} INFO - 
Model logged to MLflow with run_id: 56f41dedc06d42fea5a7eb0573b4fbee
[2025-09-11T10:25:06.552+0000] {logging_mixin.py:188} INFO - 
✅ VERIFICATION:
[2025-09-11T10:25:06.552+0000] {logging_mixin.py:188} INFO - ✅ Model uses NO current delay information!
[2025-09-11T10:25:06.553+0000] {logging_mixin.py:188} INFO - ✅ Prediction based on system health only
[2025-09-11T10:25:06.554+0000] {logging_mixin.py:188} INFO - ✅ Features used: 11
[2025-09-11T10:25:06.556+0000] {logging_mixin.py:188} INFO - ✅ Training complete - F1: 0.804
[2025-09-11T10:25:16.061+0000] {python.py:237} INFO - Done. Returned value was: training_successful
[2025-09-11T10:25:16.063+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-09-11T10:25:16.108+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=simple_monthly_training, task_id=train_model, run_id=scheduled__2025-08-01T02:00:00+00:00, execution_date=20250801T020000, start_date=20250911T101123, end_date=20250911T102516
[2025-09-11T10:25:16.323+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2025-09-11T10:25:16.548+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-09-11T10:25:16.560+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
